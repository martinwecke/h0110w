$(document).ready(function(){h0ll0w.init()});var h0ll0w=function(){var a=!0,b=function(){g.init(),i.init(),f.init(),e.init(),$(".content").focus()},c=function(a){var b=$.base64.encode(a);return b},d=function(a){var b=$.base64.decode(a);return b},e=function(){var a=$("head").attr("data-baseurl"),b=function(){j("url.init()");var b=decodeURIComponent(location.href.replace(a,""));if("#/"==b.substr(0,2)&&(b=b.substr(2)),j("query: "+b,!0),b.length>0){var c=d(b);f.update(c),i.update(a+"#/"+b)}},c=function(b){j("url.update( "+b+" )"),history.replaceState(0,document.title,a+"#/"+b)};return{init:function(){b()},update:function(a){c(a)},getBaseURL:function(){return a}}}(),f=function(){var a=null,b=function(){a=$(".content"),d(),a.focus()},d=function(){is_typing=!1,a.on("blur keyup paste",function(){is_typing||(is_typing=!0,setTimeout(function(){is_typing=!1,f()},1e3))}),dblclickTimer=0,dblclick=!1,a.on("mouseup",function(){dblclick||window.setTimeout(function(){var a=rangy.getSelection().getRangeAt(0);if(h.destroyTemp(),""!=a.toString()){j("range: "+a);var b=h.buildTemp(a);j("el: "+b),g.build(b,a)}else g.hide()},250),dblclick=!0,dblclickTimer=setTimeout(function(){dblclick=!1},250)}),$(document).on("mouseenter",".content em, .content strong",function(){g.build($(this))}),$(document).on("mouseleave",".content em, .content strong",function(){g.hide()})},f=function(){var b=a.html(),d=c(b);e.update(d),i.update(e.getBaseURL()+"#/"+d)},k=function(b){j("content.update( "+b+")"),a.html(b)};return{init:function(){b()},update:function(a){k(a)}}}(),g=function(){var a,b=function(){a=$(".tools")},c=function(a,b){j("tools.build( el: "+a+", range: "+b+")"),e();var c=$('<div class="tools" contenteditable="false"></div>');if(a)var f=(a.offset(),"TEMP"==a.get(0).tagName?"add":"remove");var g=new Array;"remove"==f?g.push($('<a href="#" class="remove" title="Remove format">Remove format</a>').on("click",function(b){b.preventDefault(),h.removeFormat(a)})):(g.push($('<a href="#" class="strong" title="strong">Strong</a>').on("click",function(a){a.preventDefault(),h.addFormat(b,"strong")})),g.push($('<a href="#" class="emphasize" title="emphasize">Emphasize</a>').on("click",function(a){a.preventDefault(),h.addFormat(b,"em")}))),$.each(g,function(){c.append($(this))}),c.prependTo(a),d()},d=function(){setTimeout(function(){a.toggleClass("active")},1)},e=function(){b(),a.removeClass("active"),f()},f=function(){b(),a.delay(500).remove()};return{init:function(){b()},build:function(a,b){c(a,b)},show:function(){d()},hide:function(){e()},destroy:function(){f()}}}(),h=function(){var a=function(a){j("selection.buildTemp( "+a+" )");var b=document.createElement("temp");return a.surroundContents(b),j($(b)),$(b)},b=function(){j("selection.destroyTemp()"),$("temp").each(function(){$(this).replaceWith($(this).html())})},c=function(a,c){j("selection.addFormat( "+a+","+c+")");var d=document.createElement(c);a.surroundContents(d),b(),a.collapse(),g.hide(),$(".content").trigger("keyup")},d=function(a){j("removeFormat()"),a.replaceWith(a.html()),g.hide(),$(".content").trigger("keyup")};return{buildTemp:function(b){return a(b)},destroyTemp:function(){b()},addFormat:function(a,b){c(a,b)},removeFormat:function(a){d(a)}}}(),i=function(){var a,b=function(){a=$("nav"),c()},c=function(){a.find(".share").on("click",function(a){a.preventDefault()}),a.find(".share input").on("click",function(){$(this).select()})},d=function(b){j("nav.update( "+b+" )"),j(a),a.find(".share input").attr("value","").attr("value",b)};return{init:function(){b()},update:function(a){d(a)}}}(),j=function(b){a&&"undefined"!=typeof console&&console.log(b)};return{init:function(){b()}}}();